  1  A                         **********************************
  2  A                         *PROGRAMA DE EJEMPLO
  3  A                         **********************************
  4  A        1026            PACTL  EQU   $1026
  5  A        1030            ADCTL  EQU   $1030
  6  A        1031            ADR1   EQU   $1031
  7  A        1032            ADR2   EQU   $1032
  8  A        1033            ADR3   EQU   $1033
  9  A        1034            ADR4   EQU   $1034
 10  A        1039            OPTION EQU   $1039
 11  A                         
 12  A        1000            PORTA  EQU   $1000
 13  A        1008            PORTD  EQU   $1008
 14  A        100A            PORTE  EQU   $100A
 15  A        1002            PORTG  EQU   $1002
 16  A                         
 17  A        1001            DDRA   EQU   $1001
 18  A        1009            DDRD   EQU   $1009
 19  A        1003            DDRG   EQU   $1003
 20  A                         
 21  A        1024            TMSK2  EQU   $1024
 22  A        1025            TFLG2  EQU   $1025
 23  A                         
 24  A        102F            SCDR   EQU   $102F
 25  A        102D            SCCR2  EQU   $102D
 26  A        102E            SCSR   EQU   $102E
 27  A        102C            SCCR1  EQU   $102C
 28  A        102B            BAUD   EQU   $102B
 29  A        103C            HPRIO  EQU   $103C
 30  A        1028            SPCR   EQU   $1028
 31  A        105D            CSCTL  EQU   $105D
 32  A        1038            OPT2   EQU   $1038
 33  A                         
 34  A                         * VARIABLES *********************
 35  A                         
 36  A        000C            ORDEN  EQU   $000C
 37  A        000D            SEG    EQU   $000D
 38  A        000E            U1     EQU   $000E
 39  A        000F            U2     EQU   $000F
 40  A        0010            U3     EQU   $0010
 41  A        0011            U4     EQU   $0011
 42  A        0012            U5     EQU   $0012
 43  A        0013            V1     EQU   $0013
 44  A        0016            BAS_L  EQU   $0016
 45  A        0017            V5     EQU   $0017
 46  A        0018            TEMPO  EQU   $0018
 47  A        0019            ALTO   EQU   $0019
 48  A        001A            BAJO   EQU   $001A
 49  A        001B            BASE_H EQU   $001B
 50  A        001C            BASE_L EQU   $001C
 51  A        001D            V3     EQU   $001D
 52  A        001E            V4     EQU   $001E
 53  A                         
 54  A                         **********************************
 55  A                         *CONFIGURA REGISTROS
 56  A                         **********************************
 57  E                        ORG   $8000   * DIR DE INICIO
   ^^^^   09- INSTRUCCION CARECE DE AL MENOS UN ESPACIO RELATIVO AL MARGEN 
 58  E                        LDS   #$03FF  * APUNTADOR DE STAK
   ^^^^   09- INSTRUCCION CARECE DE AL MENOS UN ESPACIO RELATIVO AL MARGEN 
 59  A                         
 60  A                                        
 61  E                        LDAA  #$00    * CONFIG TODO EL PUERTO  A COMO ENTRADAS
   ^^^^   09- INSTRUCCION CARECE DE AL MENOS UN ESPACIO RELATIVO AL MARGEN 
 62  E                        STAA  DDRA    * EL PUERTO A
   ^^^^   09- INSTRUCCION CARECE DE AL MENOS UN ESPACIO RELATIVO AL MARGEN 
 63  A                                
 64  A  NAN  8600F                   LDAA  #$F    * CONFIG TODO EL PUERTO  G COMO SALIDAS
 65  A  NAN  B71003                  STAA  DDRG    * EL PUERTO G 
 66  A                         
 67  A  NAN  8600                    LDAA  #$00    * SE PONE PUERTO G EN CEROS
 68  A  NAN  B71002                  STAA  PORTG
 69  A                                
 70  E                               LDD   #$302C5  * CONFIGURA PUERTO SERIAL
   ^^^^   07- MAGNITUD DE OPERANDO ERRONEA 
 71  E                               STAA  BAU    * BAUD  9600  para cristal de 8MHz
   ^^^^   02- VARIABLE INEXISTENTE 05- INSTRUCCION CARECE DE OPERANDOS 
 72  A  NAN  F7102D                  STAB  SCCR2   * HABILITA  RX Y TX PERO INTERRUPCN SOLO RX
 73  A  NAN  8600                    LDAA  #$00
 74  A  NAN  B7102C                  STAA  SCCR1   * 8 BITS
 75  A                         
 76  A  NAN  86FE                    LDAA  #$FE    * CONFIG PUERTO D COMO SALIDAS (EXCEPTO PD0)
 77  A  NAN  B71009                  STAA  DDRD    * SEA  ENABLE DEL DISPLAY  PD4  Y RS PD3
 78  A                                              
 79  A                               
 80  A  NAN  8604                    LDAA  #$04
 81  A  NAN  B7103C                  STAA  HPRIO
 82  A                         
 83  A  NAN  8600                    LDAA  #$00
 84  A  NAN  06                      TAP
 85  A                         
 86  A                         
 87  A                         
 88  A                                
 89  A                         
 90  A                         
 91  A                         
 92  A                         **********************************
 93  A                         *PROGRAMA PRINCIPAL
 94  A                         **********************************
 95  A  NAN                   MAIN   
 96  A  NAN  BD8089.8                JSR   INICIA
 97  A  NAN  863F                    LDAA  #$3F
 98  A  NAN  970C                    STAA  ORDEN         * CARGO UN (?) en 000A
 99  A                         
100  A                                
101  A  NAN                   CICLO
102  A  NAN  960D                    LDAA  SEG
103  A  NAN  27FC                    BEQ   CICLO 
104  A  NAN  7F000D                  CLR   SEG
105  A                                
106  E                               LDAA  PACNT
   ^^^^   02- VARIABLE INEXISTENTE 07- MAGNITUD DE OPERANDO ERRONEA 
107  A  NAN  9717                    STAA  V5
108  E                               CLR   PACNT
   ^^^^   02- VARIABLE INEXISTENTE 07- MAGNITUD DE OPERANDO ERRONEA 
109  A                           
110  A                                
111  A  NAN  BD819C.8                JSR   DATARXESELMEJORDETODOS        * DESPLIEGA DATO TRANSMITIDO
112  A  NAN  1809                    DEY
113  A  NAN  188F                    XGDY 
114  E                               STAA  ALTER
   ^^^^   02- VARIABLE INEXISTENTE 07- MAGNITUD DE OPERANDO ERRONEA 
115  A  NAN  D71A                    STAB  BAJO
116  A  NAN  188F                    XGDY
117  A  NAN  9619                    LDAA  ALTO
118  A  NAN  D61A                    LDAB  BAJO
119  A  NAN  BD81FD.8                JSR   BINBCD
120  A  NAN  BD8133.8                JSR   DISPLAY
121  A  NAN  BD8123.8                JSR   COMA
122  A  NAN  BD81B8.8                JSR   VOLTA
123  A                                
124  A  NAN  4F                      CLRA
125  A  NAN  D613                    LDAB  V1
126  A  NAN  BD820D.8                JSR   BNBCD
127  A  NAN  BD8152.8                JSR   DSPLY
128  A  NAN  BD8123.8                JSR   COMA
129  A                         
130  E                               CLR
   ^^^^   05- INSTRUCCION CARECE DE OPERANDOS 
131  E                               LDAB  V2
   ^^^^   02- VARIABLE INEXISTENTE 
132  A  NAN  BD820D.8                JSR   BNBCD
133  A  NAN  BD8152.8                JSR   DSPLY
134  A  NAN  BD8123.8                JSR   COMA
135  A                         
136  A  NAN  4F                      CLRA
137  E                               LDB  V3
   ^^^^   04- MNEMONICO INEXISTENTE 
138  A  NAN  BD820D.8                JSR   BNBCD
139  A  NAN  BD8152.8                JSR   DSPLY
140  A  NAN  BD8123.8                JSR   COMA
141  A                         
142  A  NAN  4F                      CLRA
143  A  NAN  D61E                    LDAB  V4
144  A  NAN  BD820D.8                JSR   BNBCD
145  A  NAN  BD8152.8                JSR   DSPLY
146  A  NAN  BD8123.8                JSR   COMA
147  A                          
148  A  NAN  4F                      CLRA
149  A  NAN  D617                    LDAB  V5
150  A  NAN  BD820D.8                JSR   BNBCD
151  A  NAN  BD8152.8                JSR   DSPLY
152  A                                
153  A  NAN  BD8180.8                JSR   CRYTRN
154  A                             
155  A  NAN  7E8027.8                JMP   CICLO
156  A                         
157  A                         
158  A                         ***********************************
159  A                         * INICIA
160  A                         ***********************************
161  A  NAN                   INICIA
162  A                              
163  A  NAN  7F000D                 CLR  SEG
164  A                         
165  A  NAN  7F1002                 CLR  PORTG
166  A  NAN  86F4                   LDAA #$F4         
167  A  NAN  9718                   STAA TEMPO         * TEMPO ES VARIABLE PARA CONTAR 244 CICLOS
168  A                         
169  A  NAN  CE1024                 LDX #TMSK2
170  A  NAN  1C0040                 BSET $00,X,#$40    * HABILITA INTERRUPCION TIMER T-REAL
171  A  NAN  0E                     CLI
172  A                         
173  A  NAN  CE1026                 LDX #PACTL
174  A  NAN  1C0050                 BSET $00,X,#$50    * HABILITA PAEN -ACUMULADOR PULSOS ALTOS-
175  E                              CLR PACNT          * BORRA ACUMULADOR DE PULSOS
   ^^^^   02- VARIABLE INEXISTENTE 07- MAGNITUD DE OPERANDO ERRONEA 
176  A                         
177  A  NAN  8610                   LDAA #$10
178  A  NAN  971B                   STAA BASE_H        * PONE UN #1060 COMO DIRECCION BASE INICIAL
179  A  NAN  8660                   LDAA #$60
180  A  NAN  971C                   STAA BASE_L    
181  A                               
182  A  NAN  18CE1060               LDY  #$1060      
183  A                               
184  A  NAN  8616                   LDAA #$16
185  E                              STAA BAS_H        * PONE UN #1653 NUMERO TOTAL DE JUEGO DE MUESTRAS
   ^^^^   02- VARIABLE INEXISTENTE 07- MAGNITUD DE OPERANDO ERRONEA 
186  A  NAN  8653                   LDAA #$53
187  A  NAN  9716                   STAA BAS_L   
188  A                         
189  A                         
190  A  NAN  7F0019                 CLR  ALTO          * INICIA INDICE MUESTRA EN 0
191  A  NAN  7F001A                 CLR  BAJO
192  A                         
193  A  NAN  39                      RTS
194  A                         ***********************************
195  A                         * SACA
196  A                         ***********************************
197  A  NAN                   SACA
198  A                                     
199  A                                
200  A  NAN  9619                    LDAA  ALTO         * INDICE DE MUESTRA (SEGUNDO)
201  A  NAN  D61A                    LDAB  BAJO
202  A  NAN  188F                    XGDY
203  A  NAN  1808                    INY
204  A  NAN  188F                    XGDY
205  A  NAN  BD81FD.8                JSR   BINBCD
206  A  NAN  BD8133.8                JSR   DISPLAY
207  A  NAN  BD8123.8                JSR   COMA
208  A                          
209  A  NAN  961B                    LDAA  BASE_H       * INDICE DE MUESTRA (PARTICULAR)
210  A  NAN  D61C                    LDAB  BASE_L
211  A  NAN  188F                    XGDY
212  A                                
213  A  NAN  1808                    INY
214  A  NAN  4F                      CLRA
215  A  NAN  18E600                  LDAB  $00,Y  
216  A  NAN  BD820D.8                JSR   BNBCD
217  A  NAN  BD8152.8                JSR   DSPLY
218  A  NAN  BD8123.8                JSR   COMA
219  A                         
220  A  NAN  1808                    INY
221  A  NAN  4F                      CLRA
222  A  NAN  18E600                  LDAB  $00,Y
223  A  NAN  BD820D.8                JSR   BNBCD
224  A  NAN  BD8152.8                JSR   DSPLY
225  A  NAN  BD8123.8                JSR   COMA
226  A                         
227  A  NAN  1808                    INY
228  A  NAN  4F                      CLRA
229  A  NAN  18E600                  LDAB  $00,Y
230  A  NAN  BD820D.8                JSR   BNBCD
231  A  NAN  BD8152.8                JSR   DSPLY
232  A  NAN  BD8123.8                JSR   COMA
233  A                         
234  A  NAN  1808                    INY
235  A  NAN  4F                      CLRA
236  A  NAN  18E600                  LDAB  $00,Y
237  A  NAN  BD820D.8                JSR   BNBCD
238  A  NAN  BD8152.8                JSR   DSPLY
239  A  NAN  BD8123.8                JSR   COMA
240  A                          
241  A  NAN  1808                    INY
242  A  NAN  4F                      CLRA 
243  A  NAN  18E600                  LDAB  $00,Y
244  A  NAN  BD820D.8                JSR   BNBCD
245  A  NAN  BD8152.8                JSR   DSPLY
246  A                                
247  A  NAN  188F                    XGDY
248  A  NAN  971B                    STAA BASE_H
249  A  NAN  D71C                    STAB BASE_L
250  A                         
251  E                               JR   CRYTRN
   ^^^^   04- MNEMONICO INEXISTENTE 02- VARIABLE INEXISTENTE 
252  A                         
253  A  NAN  39                      RTS
254  A                         ***********************************
255  A                         * COMA
256  A                         ***********************************
257  A  NAN                   COMA
258  A  NAN  CE102E                  LDX   #SCSR 
259  A                                
260  A  NAN  B6102E                  LDAA  SCSR
261  A  NAN  862C                    LDAA  #$2C             * COMA
262  A  NAN  B7102F                  STAA  SCDR
263  A  NAN                   C1
264  A  NAN  1F0080FC                BRCLR $00,X,#$80 C1 
265  A  NAN  39                      RTS
266  A                         ***********************************
267  A                         * DESPLIEGA
268  A                         ***********************************
269  A  NAN                   DISPLAY
270  A                                
271  A  NAN  CE102E                  LDX   #SCSR 
272  A                                
273  A  NAN  B6102E                  LDAA  SCSR
274  A  NAN  960E                    LDAA  U1             * U
275  A  NAN  8B30                    ADDA  #$30
276  A  NAN  B7102F                  STAA  SCDR
277  A  NAN                   T1
278  A  NAN  1F0080FC                BRCLR $00,X,#$80 T1 
279  A                               
280  A  NAN  B6102E                  LDAA  SCSR
281  A  NAN  960F                    LDAA  U2             * U2
282  A  NAN  8B30                    ADDA  #$30
283  A  NAN  B7102F                  STAA  SCDR
284  A  NAN                   T2
285  A  NAN  1F0080FC                BRCLR $00,X,#$80 T2 
286  A                         
287  A  NAN                   DSPLY  
288  A  NAN  CE102E                  LDX   #SCSR
289  A                             
290  A  NAN  B6102E                  LDAA SCSR
291  A  NAN  9610                    LDAA  U3             * U3
292  A  NAN  8B30                    ADDA  #$30
293  A  NAN  B7102F                  STAA  SCDR
294  A  NAN                   T3
295  A  NAN  1F0080FC                BRCLR $00,X,#$80 T3 
296  A                               
297  A  NAN  B6102E                  LDAA SCSR 
298  A  NAN  9611                    LDAA  U4             * U4
299  A  NAN  8B30                    ADDA  #$30
300  A  NAN  B7102F                  STAA  SCDR
301  A  NAN                   T4
302  A  NAN  1F0080FC                BRCLR $00,X,#$80 T4 
303  A                            
304  A  NAN  B6102E                  LDAA SCSR
305  A  NAN  9612                    LDAA  U5             * U5
306  A  NAN  8B30                    ADDA  #$30
307  A  NAN  B7102F                  STAA  SCDR
308  A  NAN                   T5
309  A  NAN  1F0080FC                BRCLR $00,X,#$80 T5  
310  A                                
311  A  NAN  39                      RTS
312  A                         
313  A                         ***********************************
314  A                         * CARRY RETURN
315  A                         ***********************************
316  A                         
317  A  NAN                   CRYTRN
318  A  NAN  CE102E                  LDX   #SCSR 
319  A  NAN  B6102E                  LDAA  SCSR
320  A  NAN  860A                    LDAA  #$0A             * NEW LINE     
321  A  NAN  B7102F                  STAA  SCDR
322  A  NAN                   CR1
323  A  NAN  1F0080FC                BRCLR $00,X,#$80 CR1        
324  A                         
325  A  NAN  B6102E                  LDAA SCSR
326  A  NAN  860D                    LDAA #$0D              * CARRY RETURN     
327  A  NAN  B7102F                  STAA SCDR
328  A  NAN                   CR2
329  A  NAN  1F0080FC                BRCLR $00,X,#$80 CR2        
330  A                         
331  A  NAN  39                      RTS
332  A                         ***********************************
333  A                         *  DESPLIEGUE DE DATO RECIBIDO
334  A                         ***********************************
335  A                         
336  A  NAN                   DATARXESELMEJORDETODOS
337  A                         
338  A  NAN  CE102E                  LDX   #SCSR 
339  A  NAN  B6102E                  LDAA  SCSR
340  A  NAN  960C                    LDAA  ORDEN             * NEW LINE     
341  A  NAN  B7102F                  STAA  SCDR
342  A  NAN                   DT1
343  A  NAN  1F0080FC                BRCLR $00,X,#$80 DT1        
344  A                         
345  A  NAN  B6102E                  LDAA SCSR 
346  A  NAN  863A                    LDAA #$3A              * DOS PUNTOS    
347  A  NAN  B7102F                  STAA SCDR
348  A  NAN                   DT2
349  A  NAN  1F0080FC                BRCLR $00,X,#$80 DT2        
350  A                         
351  A  NAN  39                      RTS
352  A                         ***********************************
353  A                         * voltimetro
354  A                         ***********************************
355  A  NAN                   VOLTA
356  A  NAN  CE1030                 LDX #ADCTL      
357  A                         
358  A  NAN  8680                   LDAA #$80
359  A  NAN  B71039                 STAA OPTION        * PONE EN MARCHA EL ADC
360  A                             
361  A  NAN  8610                   LDAA #$10
362  A  NAN  B71030                 STAA ADCTL         * ENTRADA MULTIPLE SELECCIONA CANAL 0
363  A                         
364  A  NAN                   E1
365  A  NAN  1F0080FC               BRCLR $00,X,#$80 E1  
366  A  NAN  F61031                 LDAB ADR1
367  A  NAN  D713                   STAB V1
368  A                               
369  A  NAN  8680                   LDAA #$80
370  A  NAN  B71039                 STAA OPTION        * PONE EN MARCHA EL ADC
371  A                             
372  A  NAN  8611                   LDAA #$11
373  A  NAN  B71030                 STAA ADCTL         * ENTRADA MULTIPLE SELECCIONA CANAL 1
374  A                         
375  A  NAN                   E2
376  A  NAN  1F0080FC               BRCLR $00,X,#$80 E2  
377  A  NAN  F61032                 LDAB ADR2
378  E                              STAB V2
   ^^^^   02- VARIABLE INEXISTENTE 
379  A                              
380  A  NAN  8612                   LDAA #$12
381  A  NAN  B71030                 STAA ADCTL         * ENTRADA MULTIPLE SELECCIONA CANAL 2
382  A                         
383  A  NAN                   E3
384  A  NAN  1F0080FC               BRCLR $00,X,#$80 E3  
385  A  NAN  F61033                 LDAB ADR3
386  A  NAN  D71D                   STAB V3 
387  A                         
388  A  NAN  8613                   LDAA #$13
389  A  NAN  B71030                 STAA ADCTL         * ENTRADA MULTIPLE SELECCIONA CANAL 3
390  A                         
391  A  NAN                   E4
392  A  NAN  1F0080FC               BRCLR $00,X,#$80 E4  
393  A  NAN  F61034                 LDAB ADR4
394  A  NAN  D71E                   STAB V4
395  A                         
396  A                                    
397  A  NAN  39                     RTS
398  A                         ***********************************
399  A                         * CONVIERTE A BCD
400  A                         ***********************************
401  A                         
402  A  NAN                   BINBCD
403  A                              
404  A  NAN  CE2710                 LDX  #$2710
405  A  NAN  02                     IDIV 
406  A  NAN  8F                     XGDX
407  A  NAN  D70E                   STAB U1
408  A  NAN  8F                     XGDX
409  A  NAN  CE03E8                 LDX  #$3E8
410  A  NAN  02                     IDIV
411  A  NAN  8F                     XGDX
412  A  NAN  D70F                   STAB U2
413  A  NAN  8F                     XGDX
414  A                         
415  A  NAN                   BNBCD
416  A  NAN  CE0064                 LDX  #$64
417  A  NAN  02                     IDIV
418  A  NAN  8F                     XGDX
419  A  NAN  D710                   STAB U3
420  A  NAN  8F                     XGDX
421  A  NAN  CE000A                 LDX  #$A
422  A  NAN  02                     IDIV
423  A  NAN  8F                     XGDX
424  A  NAN  D711                   STAB U4
425  A  NAN  8F                     XGDX
426  A  NAN  D712                   STAB U5
427  A                         
428  A                         
429  A                         
430  A  NAN  39                     RTS
431  A                         
432  A                         
433  A                         
434  A                         ***********************************
435  A                         * ATENCION A INTERRUPCION SERIAL
436  A                         ***********************************
437  A  F100                         ORG  $F100
438  A                           
439  A  F100  36                     PSHA
440  A                          
441  A  F101  B6102E                 LDAA SCSR
442  A  F104  B6102F                 LDAA SCDR
443  A  F107  970C                   STAA ORDEN
444  A                         
445  A  F109  32                     PULA  
446  A                         
447  A  F10A  3B                     RTI
448  A                         
449  A                         ***********************************
450  A                         * ATENCION A INTERRUPCION REAL TIME
451  A                         ***********************************
452  A  F110                        ORG  $F110
453  A                         
454  A  F110  36                    PSHA
455  A  F111  3C                    PSHX
456  A                         
457  A  F112  CE1025                LDX #TFLG2
458  A  F115  1C0040                BSET $00,X,#$40    * BORRA BANDERA INTERRUPCION
459  A  F118  7A0018                DEC TEMPO
460  A  F11B  2703                  BEQ SEGUNDO
461  A                               
462  A  F11D  32                    PULA
463  A  F11E  38                    PULX
464  A  F11F  3B                    RTI
465  A                         
466  A  F120                  SEGUNDO
467  A  F120  86FF                  LDAA #$FF
468  A  F122  970D                  STAA SEG           * SEG ES UNA BANDERA DE SEGUNDO    
469  A  F124  86F4                  LDAA #$F4         
470  A  F126  9718                  STAA TEMPO         * TEMPO ES VARIABLE PARA CONTAR 244 CICLOS
471  A  F128  7C1002                INC  PORTG
472  A                              
473  A  F12B  32                    PULA
474  A  F12C  38                    PULX
475  A  F12D  3B                    RTI
476  A                         ***********************************
477  A                         * VECTOR INTERRUPCION SERIAL
478  A                         ***********************************
479  A  FFD6                         ORG   $FFD6
480  A  FFD6                         FCB   $F1,$00       
481  A                         
482  A                         ***********************************
483  A                         * VECTOR INTERRUPCION REAL TIME
484  A                         ***********************************
485  A  FFF0                         ORG   $FFF0
486  A  FFF0                         FCB   $F1,$10       
487  A                         
488  A                         ***********************************
489  A                         *RESET
490  A                         ***********************************
491  A  FFFE                         ORG    $FFFE
492  E                        RESET  FCB    $80,$00
   ^^^^   09- INSTRUCCION CARECE DE AL MENOS UN ESPACIO RELATIVO AL MARGEN 
493  A                         ***********************************
494  A  FFFE                         END   $8000
